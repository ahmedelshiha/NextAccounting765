generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Attachment {
  id               String          @id
  key              String?         @unique
  url              String?
  name             String?
  size             Int?
  provider         String?
  avDetails        Json?
  avScanAt         DateTime?
  avScanTime       Float?
  avStatus         String?
  avThreatName     String?
  contentType      String?
  serviceRequestId String?
  tenantId         String
  uploadedAt       DateTime        @default(now())
  uploaderId       String?
  ServiceRequest   ServiceRequest? @relation(fields: [serviceRequestId], references: [id], onDelete: Cascade)
  Tenant           Tenant          @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  users            users?          @relation(fields: [uploaderId], references: [id])
  expenses         expenses[]

  @@index([serviceRequestId])
  @@index([tenantId])
}

model AvailabilitySlot {
  id              String        @id
  serviceId       String
  teamMemberId    String?
  date            DateTime
  startTime       String
  endTime         String
  available       Boolean       @default(true)
  reason          String?
  maxBookings     Int           @default(1)
  currentBookings Int           @default(0)
  services        services      @relation(fields: [serviceId], references: [id], onDelete: Cascade)
  team_members    team_members? @relation(fields: [teamMemberId], references: [id])

  @@unique([serviceId, teamMemberId, date, startTime])
  @@index([available, date])
  @@index([date, serviceId])
  @@index([teamMemberId, date])
}

model BookingPreferences {
  id                String   @id
  userId            String   @unique
  emailConfirmation Boolean  @default(true)
  emailReminder     Boolean  @default(true)
  emailReschedule   Boolean  @default(true)
  emailCancellation Boolean  @default(true)
  smsReminder       Boolean  @default(false)
  smsConfirmation   Boolean  @default(false)
  reminderHours     Int[]    @default([24, 2])
  timeZone          String   @default("UTC")
  preferredLanguage String   @default("en")
  createdAt         DateTime @default(now())
  updatedAt         DateTime
  users             users    @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model ComplianceRecord {
  id          String    @id
  tenantId    String
  taskId      String
  type        String
  status      String
  dueAt       DateTime?
  completedAt DateTime?
  riskScore   Int?
  notes       String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime
  Task        Task      @relation(fields: [taskId], references: [id], onDelete: Cascade)
  Tenant      Tenant    @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([tenantId, taskId])
}

model Currency {
  code          String          @id
  name          String
  symbol        String?
  decimals      Int             @default(2)
  active        Boolean         @default(false)
  isDefault     Boolean         @default(false)
  createdAt     DateTime        @default(now())
  updatedAt     DateTime
  ExchangeRate  ExchangeRate[]
  PriceOverride PriceOverride[]
}

model ExchangeRate {
  id         Int      @id @default(autoincrement())
  base       String
  target     String
  rate       Float
  source     String?
  fetchedAt  DateTime @default(now())
  ttlSeconds Int?
  Currency   Currency @relation(fields: [target], references: [code])

  @@index([base, target])
}

model HealthLog {
  id        String   @id
  tenantId  String
  service   String
  status    String
  message   String?
  checkedAt DateTime @default(now())
  Tenant    Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([tenantId, checkedAt])
  @@index([tenantId])
  @@index([tenantId, service, checkedAt])
  @@index([tenantId, service, status, checkedAt])
}

model HealthThreshold {
  id            Int      @id @default(autoincrement())
  responseTime  Int      @default(100)
  errorRate     Float    @default(1.0)
  storageGrowth Float    @default(20.0)
  createdAt     DateTime @default(now())
  updatedAt     DateTime
}

model IdempotencyKey {
  id         Int       @id @default(autoincrement())
  key        String
  userId     String?
  tenantId   String
  entityType String?
  entityId   String?
  status     String    @default("RESERVED")
  createdAt  DateTime  @default(now())
  updatedAt  DateTime
  expiresAt  DateTime?
  Tenant     Tenant    @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@unique([tenantId, key])
  @@index([tenantId])
}

model PriceOverride {
  id           Int      @id @default(autoincrement())
  entity       String
  entityId     String
  currencyCode String
  priceCents   Int
  note         String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime
  Currency     Currency @relation(fields: [currencyCode], references: [code])

  @@index([entity, entityId, currencyCode])
}

model ScheduledReminder {
  id               String         @id
  serviceRequestId String
  scheduledAt      DateTime
  channel          String         @default("EMAIL")
  sent             Boolean        @default(false)
  createdAt        DateTime       @default(now())
  tenantId         String
  ServiceRequest   ServiceRequest @relation(fields: [serviceRequestId], references: [id], onDelete: Cascade)
  Tenant           Tenant         @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([scheduledAt])
  @@index([serviceRequestId])
}

model ServiceRequest {
  id                                     String                     @id
  uuid                                   String                     @unique
  clientId                               String
  serviceId                              String
  title                                  String                     @db.VarChar(300)
  description                            String?
  priority                               RequestPriority            @default(MEDIUM)
  status                                 RequestStatus              @default(DRAFT)
  budgetMin                              Decimal?
  budgetMax                              Decimal?
  deadline                               DateTime?
  requirements                           Json?
  attachments                            Json?
  isBooking                              Boolean                    @default(false)
  scheduledAt                            DateTime?
  duration                               Int?
  clientName                             String?
  clientEmail                            String?
  clientPhone                            String?
  confirmed                              Boolean                    @default(false)
  reminderSent                           Boolean                    @default(false)
  bookingType                            BookingType?
  recurringPattern                       Json?
  parentBookingId                        String?
  assignedTeamMemberId                   String?
  assignedAt                             DateTime?
  assignedBy                             String?
  completedAt                            DateTime?
  clientApprovalAt                       DateTime?
  createdAt                              DateTime                   @default(now())
  updatedAt                              DateTime
  tenantId                               String
  paymentStatus                          PaymentStatus?
  paymentProvider                        String?
  paymentSessionId                       String?                    @unique
  paymentAmountCents                     Int?
  paymentCurrency                        String?
  paymentUpdatedAt                       DateTime?
  paymentAttempts                        Int?                       @default(0)
  Attachment                             Attachment[]
  ScheduledReminder                      ScheduledReminder[]
  users_ServiceRequest_assignedByTousers users?                     @relation("ServiceRequest_assignedByTousers", fields: [assignedBy], references: [id])
  team_members                           team_members?              @relation(fields: [assignedTeamMemberId], references: [id])
  users_ServiceRequest_clientIdTousers   users                      @relation("ServiceRequest_clientIdTousers", fields: [clientId], references: [id], onDelete: Cascade)
  ServiceRequest                         ServiceRequest?            @relation("ServiceRequestToServiceRequest", fields: [parentBookingId], references: [id])
  other_ServiceRequest                   ServiceRequest[]           @relation("ServiceRequestToServiceRequest")
  services                               services                   @relation(fields: [serviceId], references: [id])
  Tenant                                 Tenant                     @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  WorkOrder                              WorkOrder[]
  bookings                               bookings[]
  request_tasks                          request_tasks[]
  service_request_comments               service_request_comments[]

  @@index([clientId])
  @@index([isBooking, status])
  @@index([scheduledAt])
  @@index([tenantId, assignedTeamMemberId])
  @@index([tenantId])
  @@index([tenantId, isBooking, status])
  @@index([tenantId, scheduledAt])
  @@index([tenantId, status])
}

model Task {
  id                 String             @id
  tenantId           String
  title              String
  description        String?
  dueAt              DateTime?
  priority           TaskPriority       @default(MEDIUM)
  status             TaskStatus         @default(OPEN)
  assigneeId         String?
  complianceRequired Boolean            @default(false)
  complianceDeadline DateTime?
  createdAt          DateTime           @default(now())
  updatedAt          DateTime
  ComplianceRecord   ComplianceRecord[]
  users              users?             @relation(fields: [assigneeId], references: [id])
  Tenant             Tenant             @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  TaskComment        TaskComment[]
  request_tasks      request_tasks[]

  @@index([tenantId, assigneeId])
  @@index([tenantId, createdAt])
  @@index([tenantId, dueAt])
  @@index([tenantId])
  @@index([tenantId, status, dueAt])
  @@index([tenantId, status])
}

model TaskComment {
  id                String        @id
  taskId            String
  authorId          String?
  parentId          String?
  content           String
  attachments       Json?
  createdAt         DateTime      @default(now())
  updatedAt         DateTime
  users             users?        @relation(fields: [authorId], references: [id])
  TaskComment       TaskComment?  @relation("TaskCommentToTaskComment", fields: [parentId], references: [id])
  other_TaskComment TaskComment[] @relation("TaskCommentToTaskComment")
  Task              Task          @relation(fields: [taskId], references: [id], onDelete: Cascade)

  @@index([taskId])
}

model Tenant {
  id                        String                     @id
  slug                      String                     @unique
  name                      String
  status                    TenantStatus               @default(ACTIVE)
  primaryDomain             String?                    @unique
  description               String?
  featureFlags              Json?
  metadata                  Json?
  createdAt                 DateTime                   @default(now())
  updatedAt                 DateTime
  Attachment                Attachment[]
  ComplianceRecord          ComplianceRecord[]
  HealthLog                 HealthLog[]
  IdempotencyKey            IdempotencyKey[]
  ScheduledReminder         ScheduledReminder[]
  ServiceRequest            ServiceRequest[]
  Task                      Task[]
  WorkOrder                 WorkOrder[]
  audit_events              audit_events[]
  audit_logs                audit_logs[]
  booking_settings          booking_settings?
  bookings                  bookings[]
  bulk_operations           bulk_operations[]
  chat_messages             chat_messages[]
  communication_settings    communication_settings?
  cron_telemetry_settings   cron_telemetry_settings?
  crowdin_integrations      crowdin_integrations?
  custom_roles              custom_roles[]
  expenses                  expenses[]
  favorite_settings         favorite_settings[]
  integration_settings      integration_settings?
  invoices                  invoices[]
  org_localization_settings org_localization_settings?
  organization_settings     organization_settings?
  permission_audits         permission_audits[]
  permission_templates      permission_templates[]
  regional_formats          regional_formats[]
  security_settings         security_settings?
  services                  services[]
  setting_change_diffs      setting_change_diffs[]
  tenant_memberships        tenant_memberships[]
  translation_keys          translation_keys[]
  translation_metrics       translation_metrics[]
  user_workflows            user_workflows[]
  users                     users[]
  workflow_templates        workflow_templates[]
  filter_presets            filter_presets[]

  @@index([status])
}

model WorkOrder {
  id                                String          @id
  tenantId                          String
  title                             String
  description                       String?
  status                            WorkOrderStatus @default(OPEN)
  priority                          RequestPriority @default(MEDIUM)
  code                              String?         @unique
  clientId                          String?
  serviceId                         String?
  serviceRequestId                  String?
  bookingId                         String?
  assigneeId                        String?
  dueAt                             DateTime?
  startedAt                         DateTime?
  completedAt                       DateTime?
  estimatedHours                    Int?
  actualHours                       Int?
  costCents                         Int?
  currency                          String?
  tags                              String[]
  createdAt                         DateTime        @default(now())
  updatedAt                         DateTime
  users_WorkOrder_assigneeIdTousers users?          @relation("WorkOrder_assigneeIdTousers", fields: [assigneeId], references: [id])
  bookings                          bookings?       @relation(fields: [bookingId], references: [id])
  users_WorkOrder_clientIdTousers   users?          @relation("WorkOrder_clientIdTousers", fields: [clientId], references: [id])
  services                          services?       @relation(fields: [serviceId], references: [id])
  ServiceRequest                    ServiceRequest? @relation(fields: [serviceRequestId], references: [id])
  Tenant                            Tenant          @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([assigneeId])
  @@index([createdAt])
  @@index([dueAt])
  @@index([status, priority])
  @@index([tenantId])
}

model accounts {
  id                String  @id
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?
  users             users   @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
}

model audit_events {
  id        String   @id
  tenantId  String?
  userId    String?
  type      String
  resource  String?
  details   Json?
  createdAt DateTime @default(now())
  Tenant    Tenant?  @relation(fields: [tenantId], references: [id])
  users     users?   @relation(fields: [userId], references: [id])

  @@index([createdAt])
  @@index([tenantId, createdAt])
  @@index([type, createdAt])
}

model audit_logs {
  id        String   @id
  tenantId  String?
  userId    String?
  action    String
  resource  String?
  metadata  Json?
  ipAddress String?
  userAgent String?
  createdAt DateTime @default(now())
  Tenant    Tenant?  @relation(fields: [tenantId], references: [id])
  users     users?   @relation(fields: [userId], references: [id])

  @@index([action, createdAt])
  @@index([createdAt])
  @@index([tenantId, createdAt])
  @@index([userId, createdAt])
}

model booking_settings {
  id                        String                   @id
  tenantId                  String                   @unique
  bookingEnabled            Boolean                  @default(true)
  requireApproval           Boolean                  @default(false)
  allowCancellation         Boolean                  @default(true)
  allowRescheduling         Boolean                  @default(true)
  cancellationDeadlineHours Int                      @default(24)
  rescheduleDeadlineHours   Int                      @default(4)
  paymentRequired           Boolean                  @default(false)
  acceptCash                Boolean                  @default(true)
  acceptCard                Boolean                  @default(true)
  acceptBankTransfer        Boolean                  @default(false)
  acceptWire                Boolean                  @default(false)
  acceptCrypto              Boolean                  @default(false)
  requireFullPayment        Boolean                  @default(false)
  allowPartialPayment       Boolean                  @default(true)
  depositPercentage         Int                      @default(50)
  enableServiceSelection    Boolean                  @default(true)
  enableDateTimeSelection   Boolean                  @default(true)
  enableCustomerDetails     Boolean                  @default(true)
  enableAdditionalServices  Boolean                  @default(true)
  enablePaymentStep         Boolean                  @default(false)
  enableConfirmationStep    Boolean                  @default(true)
  enableFileUpload          Boolean                  @default(false)
  enableSpecialRequests     Boolean                  @default(true)
  advanceBookingDays        Int                      @default(365)
  minAdvanceBookingHours    Int                      @default(2)
  maxBookingsPerDay         Int                      @default(50)
  maxBookingsPerCustomer    Int                      @default(5)
  bufferTimeBetweenBookings Int                      @default(15)
  businessHours             Json?
  blackoutDates             Json?
  holidaySchedule           Json?
  sendBookingConfirmation   Boolean                  @default(true)
  sendReminders             Boolean                  @default(true)
  reminderHours             Json?
  notifyTeamMembers         Boolean                  @default(true)
  emailNotifications        Boolean                  @default(true)
  smsNotifications          Boolean                  @default(false)
  requireLogin              Boolean                  @default(false)
  allowGuestBooking         Boolean                  @default(true)
  showPricing               Boolean                  @default(true)
  showTeamMemberSelection   Boolean                  @default(false)
  allowRecurringBookings    Boolean                  @default(false)
  enableWaitlist            Boolean                  @default(false)
  enableAutoAssignment      Boolean                  @default(false)
  assignmentStrategy        String                   @default("ROUND_ROBIN")
  considerWorkload          Boolean                  @default(true)
  considerSpecialization    Boolean                  @default(true)
  enableDynamicPricing      Boolean                  @default(false)
  peakHoursSurcharge        Decimal                  @default(0.0)
  weekendSurcharge          Decimal                  @default(0.0)
  emergencyBookingSurcharge Decimal                  @default(0.5)
  calendarSync              Boolean                  @default(false)
  webhookUrl                String?
  apiAccessEnabled          Boolean                  @default(false)
  automation                Json?
  integrations              Json?
  capacity                  Json?
  forms                     Json?
  createdAt                 DateTime                 @default(now())
  updatedAt                 DateTime
  updatedBy                 String?
  Tenant                    Tenant                   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  booking_step_config       booking_step_config[]
  business_hours_config     business_hours_config[]
  notification_templates    notification_templates[]
  payment_method_config     payment_method_config[]

  @@index([tenantId])
}

model booking_step_config {
  id                String           @id
  bookingSettingsId String
  stepName          String
  stepOrder         Int
  enabled           Boolean          @default(true)
  required          Boolean          @default(true)
  title             String
  description       String?
  validationRules   Json?
  customFields      Json?
  createdAt         DateTime         @default(now())
  booking_settings  booking_settings @relation(fields: [bookingSettingsId], references: [id], onDelete: Cascade)

  @@index([bookingSettingsId, stepOrder])
}

model bookings {
  id                   String          @id
  clientId             String
  serviceId            String
  status               BookingStatus   @default(PENDING)
  scheduledAt          DateTime
  duration             Int
  notes                String?
  clientName           String
  clientEmail          String
  clientPhone          String?
  adminNotes           String?
  confirmed            Boolean         @default(false)
  reminderSent         Boolean         @default(false)
  tenantId             String
  createdAt            DateTime        @default(now())
  updatedAt            DateTime
  assignedTeamMemberId String?
  serviceRequestId     String?
  WorkOrder            WorkOrder[]
  team_members         team_members?   @relation(fields: [assignedTeamMemberId], references: [id])
  users                users           @relation(fields: [clientId], references: [id], onDelete: Cascade)
  services             services        @relation(fields: [serviceId], references: [id], onDelete: Cascade)
  ServiceRequest       ServiceRequest? @relation(fields: [serviceRequestId], references: [id])
  Tenant               Tenant          @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  invoices             invoices[]

  @@index([clientEmail])
  @@index([clientId])
  @@index([createdAt])
  @@index([scheduledAt])
  @@index([serviceId])
  @@index([status])
  @@index([status, scheduledAt])
  @@index([tenantId])
}

model bulk_operation_history {
  id               String          @id
  bulkOperationId  String
  eventType        String
  eventDescription String?
  changedBy        String?
  oldValue         Json?
  newValue         Json?
  createdAt        DateTime        @default(now())
  bulk_operations  bulk_operations @relation(fields: [bulkOperationId], references: [id], onDelete: Cascade)
  users            users?          @relation(fields: [changedBy], references: [id])

  @@index([bulkOperationId, createdAt])
}

model bulk_operation_results {
  id              String          @id
  bulkOperationId String
  userId          String
  status          String
  errorMessage    String?
  changesBefore   Json?
  changesAfter    Json?
  executionTimeMs Int?
  createdAt       DateTime        @default(now())
  updatedAt       DateTime
  bulk_operations bulk_operations @relation(fields: [bulkOperationId], references: [id], onDelete: Cascade)
  users           users           @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([bulkOperationId, status])
  @@index([userId, createdAt])
}

model bulk_operations {
  id                                      String                   @id
  tenantId                                String
  name                                    String                   @db.VarChar(255)
  description                             String?
  type                                    BulkOperationType
  userFilter                              Json?
  operationConfig                         Json
  status                                  BulkOperationStatus      @default(DRAFT)
  createdBy                               String
  approvalRequired                        Boolean                  @default(false)
  approvalStatus                          String?
  approvedBy                              String?
  approvedAt                              DateTime?
  scheduledFor                            DateTime?
  notifyUsers                             Boolean                  @default(true)
  dryRunResults                           Json?
  totalUsersAffected                      Int                      @default(0)
  successCount                            Int                      @default(0)
  failureCount                            Int                      @default(0)
  startedAt                               DateTime?
  completedAt                             DateTime?
  errorMessage                            String?
  rollbackAvailable                       Boolean                  @default(true)
  rollbackUntilDate                       DateTime?
  createdAt                               DateTime                 @default(now())
  updatedAt                               DateTime
  bulk_operation_history                  bulk_operation_history[]
  bulk_operation_results                  bulk_operation_results[]
  users_bulk_operations_approvedByTousers users?                   @relation("bulk_operations_approvedByTousers", fields: [approvedBy], references: [id])
  users_bulk_operations_createdByTousers  users                    @relation("bulk_operations_createdByTousers", fields: [createdBy], references: [id])
  Tenant                                  Tenant                   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([createdBy, createdAt])
  @@index([status])
  @@index([tenantId, status, createdAt])
}

model business_hours_config {
  id                 String           @id
  bookingSettingsId  String
  dayOfWeek          Int
  isWorkingDay       Boolean          @default(true)
  startTime          String?
  endTime            String?
  breakStartTime     String?
  breakEndTime       String?
  maxBookingsPerHour Int              @default(4)
  booking_settings   booking_settings @relation(fields: [bookingSettingsId], references: [id], onDelete: Cascade)

  @@index([bookingSettingsId, dayOfWeek])
}

model chat_messages {
  id        String   @id
  tenantId  String
  room      String?
  userId    String
  userName  String
  role      String
  text      String
  createdAt DateTime @default(now())
  Tenant    Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([tenantId, room, createdAt])
}

model communication_settings {
  id            String   @id
  tenantId      String   @unique
  email         Json?
  sms           Json?
  chat          Json?
  notifications Json?
  newsletters   Json?
  reminders     Json?
  createdAt     DateTime @default(now())
  updatedAt     DateTime
  Tenant        Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([tenantId])
}

model contact_submissions {
  id        String   @id
  name      String
  email     String
  phone     String?
  company   String?
  subject   String?
  message   String
  source    String?
  responded Boolean  @default(false)
  createdAt DateTime @default(now())

  @@index([createdAt])
  @@index([responded, createdAt])
}

model cron_telemetry_settings {
  id          String   @id
  tenantId    String   @unique
  performance Json?
  reliability Json?
  monitoring  Json?
  status      Json?
  scheduling  Json?
  createdAt   DateTime @default(now())
  updatedAt   DateTime
  Tenant      Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([tenantId])
}

model crowdin_integrations {
  id                String    @id
  tenantId          String    @unique
  projectId         String    @db.VarChar(100)
  apiTokenMasked    String    @db.VarChar(20)
  apiTokenEncrypted String
  autoSyncDaily     Boolean   @default(true)
  syncOnDeploy      Boolean   @default(false)
  createPrs         Boolean   @default(true)
  lastSyncAt        DateTime?
  lastSyncStatus    String?   @db.VarChar(50)
  testConnectionOk  Boolean   @default(false)
  createdAt         DateTime  @default(now())
  updatedAt         DateTime
  Tenant            Tenant    @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([tenantId])
}

model custom_roles {
  id          String   @id
  tenantId    String
  name        String   @db.VarChar(100)
  description String?
  color       String?  @db.VarChar(20)
  icon        String?  @db.VarChar(50)
  permissions Json     @default("[]")
  isActive    Boolean  @default(true)
  createdBy   String
  createdAt   DateTime @default(now())
  updatedAt   DateTime
  users       users    @relation(fields: [createdBy], references: [id], onDelete: SetNull)
  Tenant      Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@unique([tenantId, name])
  @@index([tenantId])
  @@index([tenantId, isActive])
}

model expenses {
  id           String      @id
  tenantId     String
  vendor       String
  category     String?
  status       String      @default("PENDING")
  amountCents  Int
  currency     String      @default("USD")
  date         DateTime
  attachmentId String?
  userId       String?
  createdAt    DateTime    @default(now())
  updatedAt    DateTime
  Attachment   Attachment? @relation(fields: [attachmentId], references: [id])
  Tenant       Tenant      @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  users        users?      @relation(fields: [userId], references: [id])

  @@index([date])
  @@index([status])
  @@index([tenantId])
}

model favorite_settings {
  id         String   @id
  tenantId   String
  userId     String
  settingKey String
  route      String
  label      String
  createdAt  DateTime @default(now())
  Tenant     Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  users      users    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([tenantId, userId, settingKey])
  @@index([tenantId, userId])
}

model integration_settings {
  id        String   @id
  tenantId  String   @unique
  payments  Json?
  calendars Json?
  comms     Json?
  analytics Json?
  storage   Json?
  createdAt DateTime @default(now())
  updatedAt DateTime
  Tenant    Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([tenantId])
}

model invoice_items {
  id             String   @id
  invoiceId      String
  description    String
  quantity       Int      @default(1)
  unitPriceCents Int      @default(0)
  totalCents     Int      @default(0)
  invoices       invoices @relation(fields: [invoiceId], references: [id], onDelete: Cascade)

  @@index([invoiceId])
}

model invoices {
  id            String          @id
  tenantId      String
  bookingId     String?
  clientId      String?
  number        String?         @unique
  status        InvoiceStatus   @default(UNPAID)
  currency      String          @default("USD")
  totalCents    Int             @default(0)
  paidAt        DateTime?
  createdAt     DateTime        @default(now())
  updatedAt     DateTime
  invoice_items invoice_items[]
  bookings      bookings?       @relation(fields: [bookingId], references: [id])
  users         users?          @relation(fields: [clientId], references: [id])
  Tenant        Tenant          @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([bookingId])
  @@index([clientId])
  @@index([tenantId])
}

model languages {
  code        String   @id @default("en") @db.VarChar(10)
  name        String   @db.VarChar(100)
  nativeName  String   @db.VarChar(100)
  direction   String   @default("ltr") @db.VarChar(3)
  flag        String?  @db.VarChar(5)
  bcp47Locale String   @db.VarChar(10)
  enabled     Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime

  @@index([enabled])
}

model menu_customizations {
  id            String   @id
  userId        String   @unique
  practiceItems Json     @default("[]")
  bookmarks     Json     @default("[]")
  createdAt     DateTime @default(now())
  updatedAt     DateTime
  sectionOrder  Json     @default("[]")
  hiddenItems   Json     @default("[]")
  users         users    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
}

model newsletter {
  id         String   @id
  email      String   @unique
  name       String?
  subscribed Boolean  @default(true)
  source     String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime
}

model notification_settings {
  id           String   @id
  emailEnabled Boolean  @default(false)
  emailFrom    String?
  webhookUrl   String?
  templates    Json?
  createdAt    DateTime @default(now())
  updatedAt    DateTime
}

model notification_templates {
  id                String           @id
  bookingSettingsId String
  templateType      String
  channel           String
  enabled           Boolean          @default(true)
  subject           String?
  content           String
  variables         Json?
  booking_settings  booking_settings @relation(fields: [bookingSettingsId], references: [id], onDelete: Cascade)

  @@index([bookingSettingsId, templateType])
}

model org_localization_settings {
  id                         String   @id
  tenantId                   String   @unique
  defaultLanguage            String   @default("en") @db.VarChar(10)
  fallbackLanguage           String   @default("en") @db.VarChar(10)
  showLanguageSwitcher       Boolean  @default(true)
  persistLanguagePreference  Boolean  @default(true)
  autoDetectBrowserLanguage  Boolean  @default(true)
  allowUserLanguageOverride  Boolean  @default(true)
  enableRtlSupport           Boolean  @default(true)
  missingTranslationBehavior String   @default("show-fallback") @db.VarChar(20)
  createdAt                  DateTime @default(now())
  updatedAt                  DateTime
  Tenant                     Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([tenantId])
}

model organization_settings {
  id              String   @id
  tenantId        String   @unique
  name            String
  logoUrl         String?
  tagline         String?
  description     String?
  industry        String?
  contactEmail    String?
  contactPhone    String?
  address         Json?
  defaultTimezone String?  @default("UTC")
  defaultCurrency String?  @default("USD")
  defaultLocale   String?  @default("en")
  branding        Json?
  legalLinks      Json?
  termsUrl        String?
  privacyUrl      String?
  refundUrl       String?
  createdAt       DateTime @default(now())
  updatedAt       DateTime
  Tenant          Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([tenantId])
}

model payment_method_config {
  id                String           @id
  bookingSettingsId String
  methodType        String
  enabled           Boolean          @default(true)
  displayName       String
  description       String?
  processingFee     Decimal          @default(0.0)
  minAmount         Decimal          @default(0.0)
  maxAmount         Decimal?
  gatewayConfig     Json?
  booking_settings  booking_settings @relation(fields: [bookingSettingsId], references: [id], onDelete: Cascade)

  @@unique([bookingSettingsId, methodType])
}

model permission_audits {
  id                                       String   @id
  tenantId                                 String
  userId                                   String
  changedBy                                String
  oldRole                                  String?  @db.VarChar(100)
  newRole                                  String?  @db.VarChar(100)
  permissionsAdded                         Json     @default("[]")
  permissionsRemoved                       Json     @default("[]")
  reason                                   String?
  metadata                                 Json?
  createdAt                                DateTime @default(now())
  users_permission_audits_changedByTousers users    @relation("permission_audits_changedByTousers", fields: [changedBy], references: [id], onDelete: SetNull)
  Tenant                                   Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  users_permission_audits_userIdTousers    users    @relation("permission_audits_userIdTousers", fields: [userId], references: [id], onDelete: Cascade)

  @@index([changedBy])
  @@index([createdAt])
  @@index([tenantId, createdAt])
  @@index([tenantId])
  @@index([userId])
}

model permission_templates {
  id          String   @id
  tenantId    String
  name        String   @db.VarChar(100)
  description String?
  icon        String?  @db.VarChar(50)
  color       String?  @db.VarChar(20)
  permissions Json     @default("[]")
  isCustom    Boolean  @default(true)
  isActive    Boolean  @default(true)
  createdBy   String
  createdAt   DateTime @default(now())
  updatedAt   DateTime
  users       users    @relation(fields: [createdBy], references: [id], onDelete: SetNull)
  Tenant      Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@unique([tenantId, name])
  @@index([isActive])
  @@index([tenantId])
  @@index([tenantId, isActive])
}

model posts {
  id             String       @id
  title          String
  slug           String       @unique
  content        String
  excerpt        String?
  published      Boolean      @default(false)
  featured       Boolean      @default(false)
  coverImage     String?
  seoTitle       String?
  seoDescription String?
  tags           String[]
  readTime       Int?
  views          Int          @default(0)
  authorId       String
  createdAt      DateTime     @default(now())
  updatedAt      DateTime
  publishedAt    DateTime?
  status         PostStatus   @default(DRAFT)
  archived       Boolean      @default(false)
  scheduledAt    DateTime?
  priority       PostPriority @default(MEDIUM)
  category       String?
  reviewRequired Boolean      @default(false)
  isCompliant    Boolean      @default(true)
  approvedBy     String?
  version        Int          @default(1)
  shares         Int          @default(0)
  comments       Int          @default(0)
  users          users        @relation(fields: [authorId], references: [id], onDelete: Cascade)

  @@index([featured])
  @@index([publishedAt])
}

model regional_formats {
  id                 String   @id
  tenantId           String
  languageCode       String   @db.VarChar(10)
  dateFormat         String   @db.VarChar(50)
  timeFormat         String   @db.VarChar(50)
  currencyCode       String   @db.VarChar(3)
  currencySymbol     String   @db.VarChar(10)
  numberFormat       String   @db.VarChar(50)
  decimalSeparator   String   @db.VarChar(1)
  thousandsSeparator String   @db.VarChar(1)
  createdAt          DateTime @default(now())
  updatedAt          DateTime
  Tenant             Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@unique([tenantId, languageCode])
  @@index([languageCode])
  @@index([tenantId])
}

model request_tasks {
  id               String         @id
  serviceRequestId String
  taskId           String
  createdAt        DateTime       @default(now())
  ServiceRequest   ServiceRequest @relation(fields: [serviceRequestId], references: [id], onDelete: Cascade)
  Task             Task           @relation(fields: [taskId], references: [id], onDelete: Cascade)

  @@unique([serviceRequestId, taskId])
}

model security_settings {
  id              String   @id
  tenantId        String   @unique
  passwordPolicy  Json?
  sessionSecurity Json?
  twoFactor       Json?
  network         Json?
  dataProtection  Json?
  compliance      Json?
  superAdmin      Json?
  createdAt       DateTime @default(now())
  updatedAt       DateTime
  Tenant          Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([tenantId])
}

model service_request_comments {
  id               String         @id
  serviceRequestId String
  authorId         String?
  content          String
  attachments      Json?
  createdAt        DateTime       @default(now())
  updatedAt        DateTime
  users            users?         @relation(fields: [authorId], references: [id])
  ServiceRequest   ServiceRequest @relation(fields: [serviceRequestId], references: [id], onDelete: Cascade)
}

model service_views {
  id         String   @id
  service_id String
  tenant_id  String?
  ip         String?
  user_agent String?
  created_at DateTime @default(now())
  services   services @relation(fields: [service_id], references: [id], onDelete: Cascade)

  @@index([service_id, created_at])
}

model services {
  id                     String             @id
  name                   String
  slug                   String
  description            String
  shortDesc              String?
  features               String[]
  price                  Decimal?
  duration               Int?
  category               String?
  active                 Boolean            @default(true)
  featured               Boolean            @default(false)
  image                  String?
  serviceSettings        Json?
  views                  Int                @default(0)
  createdAt              DateTime           @default(now())
  updatedAt              DateTime
  basePrice              Decimal?
  estimatedDurationHours Int?
  requiredSkills         String[]
  status                 ServiceStatus      @default(ACTIVE)
  tenantId               String
  bookingEnabled         Boolean            @default(true)
  advanceBookingDays     Int                @default(30)
  minAdvanceHours        Int                @default(24)
  maxDailyBookings       Int?
  bufferTime             Int                @default(0)
  businessHours          Json?
  blackoutDates          DateTime[]
  AvailabilitySlot       AvailabilitySlot[]
  ServiceRequest         ServiceRequest[]
  WorkOrder              WorkOrder[]
  bookings               bookings[]
  service_views          service_views[]
  Tenant                 Tenant             @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@unique([tenantId, slug])
  @@index([active, bookingEnabled])
  @@index([active, featured])
  @@index([createdAt])
  @@index([status])
  @@index([tenantId])
  @@index([updatedAt])
}

model sessions {
  id           String   @id
  sessionToken String   @unique
  userId       String
  expires      DateTime
  users        users    @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model setting_change_diffs {
  id        String   @id
  tenantId  String
  userId    String?
  category  String
  resource  String?
  before    Json?
  after     Json?
  createdAt DateTime @default(now())
  Tenant    Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  users     users?   @relation(fields: [userId], references: [id])

  @@index([tenantId, category, createdAt])
  @@index([tenantId, createdAt])
}

model sidebar_preferences {
  id             String   @id
  userId         String   @unique
  collapsed      Boolean  @default(false)
  width          Int      @default(256)
  mobileOpen     Boolean  @default(false)
  expandedGroups String[] @default(["dashboard", "business"])
  createdAt      DateTime @default(now())
  updatedAt      DateTime

  @@index([userId])
}

model task_templates {
  id                  String       @id
  name                String
  content             String
  description         String?
  category            String?
  defaultPriority     TaskPriority @default(MEDIUM)
  defaultCategory     String?
  estimatedHours      Int?
  checklistItems      String[]
  requiredSkills      String[]
  defaultAssigneeRole String?
  createdById         String?
  createdAt           DateTime     @default(now())
  updatedAt           DateTime
  users               users?       @relation(fields: [createdById], references: [id])

  @@index([category])
}

model team_members {
  id                    String             @id
  name                  String
  email                 String?
  userId                String?
  title                 String?
  role                  UserRole?          @default(TEAM_MEMBER)
  department            String?
  specialties           String[]
  hourlyRate            Decimal?
  isAvailable           Boolean            @default(true)
  status                String?            @default("active")
  workingHours          Json?
  timeZone              String?            @default("UTC")
  maxConcurrentBookings Int                @default(3)
  bookingBuffer         Int                @default(15)
  autoAssign            Boolean            @default(true)
  stats                 Json?
  createdAt             DateTime           @default(now())
  updatedAt             DateTime
  AvailabilitySlot      AvailabilitySlot[]
  ServiceRequest        ServiceRequest[]
  bookings              bookings[]
  users                 users?             @relation(fields: [userId], references: [id])

  @@index([isAvailable])
  @@index([status])
}

model tenant_memberships {
  id        String   @id
  userId    String
  tenantId  String
  role      UserRole @default(CLIENT)
  isDefault Boolean  @default(false)
  createdAt DateTime @default(now())
  Tenant    Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  users     users    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, tenantId])
  @@index([tenantId])
  @@index([userId])
}

model translation_keys {
  id           String   @id
  tenantId     String
  key          String
  namespace    String?
  enTranslated Boolean  @default(true)
  arTranslated Boolean  @default(false)
  hiTranslated Boolean  @default(false)
  lastUpdated  DateTime
  addedAt      DateTime @default(now())
  Tenant       Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@unique([tenantId, key])
  @@index([addedAt])
  @@index([tenantId, arTranslated])
  @@index([tenantId, enTranslated])
  @@index([tenantId, hiTranslated])
  @@index([tenantId, namespace])
}

model translation_metrics {
  id               String   @id
  tenantId         String
  date             DateTime @db.Date
  enTotal          Int      @default(0)
  enTranslated     Int      @default(0)
  arTotal          Int      @default(0)
  arTranslated     Int      @default(0)
  hiTotal          Int      @default(0)
  hiTranslated     Int      @default(0)
  totalUniqueKeys  Int      @default(0)
  usersWithArabic  Int      @default(0)
  usersWithHindi   Int      @default(0)
  usersWithEnglish Int      @default(0)
  enCoveragePct    Decimal  @default(0) @db.Decimal(5, 2)
  arCoveragePct    Decimal  @default(0) @db.Decimal(5, 2)
  hiCoveragePct    Decimal  @default(0) @db.Decimal(5, 2)
  createdAt        DateTime @default(now())
  Tenant           Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@unique([tenantId, date])
  @@index([date])
  @@index([tenantId, date])
}

model translation_priorities {
  id               String         @id
  key              String
  notes            String?
  assignedToUserId String?
  createdAt        DateTime       @default(now())
  dueDate          DateTime?
  languageCode     String?        @db.VarChar(10)
  tenantId         String
  updatedAt        DateTime
  priority         Priority       @default(MEDIUM)
  status           PriorityStatus @default(OPEN)

  @@unique([tenantId, key, languageCode])
  @@index([tenantId])
}

model user_permissions {
  id                                        String   @id
  userId                                    String
  grantedById                               String?
  permission                                String
  scope                                     String?
  createdAt                                 DateTime @default(now())
  users_user_permissions_grantedByIdTousers users?   @relation("user_permissions_grantedByIdTousers", fields: [grantedById], references: [id])
  users_user_permissions_userIdTousers      users    @relation("user_permissions_userIdTousers", fields: [userId], references: [id], onDelete: Cascade)
}

model user_profiles {
  id                       String    @id
  userId                   String    @unique
  organization             String?
  phoneNumber              String?
  phoneNumberVerified      DateTime?
  twoFactorEnabled         Boolean   @default(false)
  twoFactorSecret          String?
  lastLoginAt              DateTime?
  lastLoginIp              String?
  loginAttempts            Int       @default(0)
  lockoutUntil             DateTime?
  metadata                 Json?
  createdAt                DateTime  @default(now())
  updatedAt                DateTime
  bookingEmailCancellation Boolean?  @default(true)
  bookingEmailConfirm      Boolean?  @default(true)
  bookingEmailReminder     Boolean?  @default(true)
  bookingEmailReschedule   Boolean?  @default(true)
  bookingSmsConfirmation   Boolean?  @default(false)
  bookingSmsReminder       Boolean?  @default(false)
  preferredLanguage        String?   @default("en")
  reminderHours            Int[]     @default([24, 2])
  timezone                 String?   @default("UTC")
  users                    users     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
}

model user_workflows {
  id                                      String                   @id
  tenantId                                String
  userId                                  String
  type                                    WorkflowType
  status                                  WorkflowStatus           @default(DRAFT)
  triggeredBy                             String
  approvedBy                              String?
  startedAt                               DateTime?
  completedAt                             DateTime?
  scheduledFor                            DateTime?
  totalSteps                              Int
  completedSteps                          Int                      @default(0)
  progressPercent                         Int                      @default(0)
  errorMessage                            String?
  retryCount                              Int                      @default(0)
  lastErrorAt                             DateTime?
  dueAt                                   DateTime?
  createdAt                               DateTime                 @default(now())
  updatedAt                               DateTime
  users_user_workflows_approvedByTousers  users?                   @relation("user_workflows_approvedByTousers", fields: [approvedBy], references: [id])
  Tenant                                  Tenant                   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  users_user_workflows_triggeredByTousers users                    @relation("user_workflows_triggeredByTousers", fields: [triggeredBy], references: [id])
  users_user_workflows_userIdTousers      users                    @relation("user_workflows_userIdTousers", fields: [userId], references: [id], onDelete: Cascade)
  workflow_history                        workflow_history[]
  workflow_notifications                  workflow_notifications[]
  workflow_steps                          workflow_steps[]

  @@index([tenantId, status, createdAt])
  @@index([userId, createdAt])
}

model users {
  id                                                   String                     @id
  tenantId                                             String
  email                                                String
  name                                                 String?
  password                                             String?
  image                                                String?
  role                                                 UserRole                   @default(CLIENT)
  emailVerified                                        DateTime?
  createdAt                                            DateTime                   @default(now())
  updatedAt                                            DateTime
  sessionVersion                                       Int                        @default(0)
  employeeId                                           String?                    @unique
  department                                           String?
  position                                             String?
  skills                                               String[]
  expertiseLevel                                       ExpertiseLevel?
  hourlyRate                                           Decimal?
  availabilityStatus                                   AvailabilityStatus         @default(AVAILABLE)
  maxConcurrentProjects                                Int?                       @default(3)
  hireDate                                             DateTime?
  managerId                                            String?
  tier                                                 String?
  certifications                                       String[]                   @default([])
  experienceYears                                      Int?
  Attachment                                           Attachment[]
  BookingPreferences                                   BookingPreferences?
  ServiceRequest_ServiceRequest_assignedByTousers      ServiceRequest[]           @relation("ServiceRequest_assignedByTousers")
  ServiceRequest_ServiceRequest_clientIdTousers        ServiceRequest[]           @relation("ServiceRequest_clientIdTousers")
  Task                                                 Task[]
  TaskComment                                          TaskComment[]
  WorkOrder_WorkOrder_assigneeIdTousers                WorkOrder[]                @relation("WorkOrder_assigneeIdTousers")
  WorkOrder_WorkOrder_clientIdTousers                  WorkOrder[]                @relation("WorkOrder_clientIdTousers")
  accounts                                             accounts[]
  audit_events                                         audit_events[]
  audit_logs                                           audit_logs[]
  bookings                                             bookings[]
  bulk_operation_history                               bulk_operation_history[]
  bulk_operation_results                               bulk_operation_results[]
  bulk_operations_bulk_operations_approvedByTousers    bulk_operations[]          @relation("bulk_operations_approvedByTousers")
  bulk_operations_bulk_operations_createdByTousers     bulk_operations[]          @relation("bulk_operations_createdByTousers")
  custom_roles                                         custom_roles[]
  expenses                                             expenses[]
  favorite_settings                                    favorite_settings[]
  invoices                                             invoices[]
  menu_customizations                                  menu_customizations?
  permission_audits_permission_audits_changedByTousers permission_audits[]        @relation("permission_audits_changedByTousers")
  permission_audits_permission_audits_userIdTousers    permission_audits[]        @relation("permission_audits_userIdTousers")
  permission_templates                                 permission_templates[]
  posts                                                posts[]
  service_request_comments                             service_request_comments[]
  sessions                                             sessions[]
  setting_change_diffs                                 setting_change_diffs[]
  task_templates                                       task_templates[]
  team_members                                         team_members[]
  tenant_memberships                                   tenant_memberships[]
  user_permissions_user_permissions_grantedByIdTousers user_permissions[]         @relation("user_permissions_grantedByIdTousers")
  user_permissions_user_permissions_userIdTousers      user_permissions[]         @relation("user_permissions_userIdTousers")
  user_profiles                                        user_profiles?
  user_workflows_user_workflows_approvedByTousers      user_workflows[]           @relation("user_workflows_approvedByTousers")
  user_workflows_user_workflows_triggeredByTousers     user_workflows[]           @relation("user_workflows_triggeredByTousers")
  user_workflows_user_workflows_userIdTousers          user_workflows[]           @relation("user_workflows_userIdTousers")
  users                                                users?                     @relation("usersTousers", fields: [managerId], references: [id])
  other_users                                          users[]                    @relation("usersTousers")
  Tenant                                               Tenant                     @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  workflow_history                                     workflow_history[]
  workflow_steps                                       workflow_steps[]
  workflow_templates                                   workflow_templates[]
  filter_presets                                       filter_presets[]           @relation("FilterPresetCreatedBy")

  @@unique([tenantId, email])
  @@index([experienceYears])
  @@index([tenantId, createdAt])
  @@index([tenantId, role])
  @@index([tier])
}

model verificationtokens {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

model workflow_history {
  id               String         @id
  workflowId       String
  eventType        String
  eventDescription String?
  changedBy        String
  oldValue         Json?
  newValue         Json?
  createdAt        DateTime       @default(now())
  users            users          @relation(fields: [changedBy], references: [id])
  user_workflows   user_workflows @relation(fields: [workflowId], references: [id], onDelete: Cascade)

  @@index([workflowId, createdAt])
}

model workflow_notifications {
  id             String         @id
  workflowId     String
  emailTo        String
  emailSubject   String
  emailBody      String
  status         String         @default("PENDING")
  sentAt         DateTime?
  errorMessage   String?
  createdAt      DateTime       @default(now())
  user_workflows user_workflows @relation(fields: [workflowId], references: [id], onDelete: Cascade)

  @@index([workflowId, createdAt])
}

model workflow_steps {
  id               String         @id
  workflowId       String
  stepNumber       Int
  name             String
  description      String?
  actionType       String
  status           StepStatus     @default(PENDING)
  config           Json?
  startedAt        DateTime?
  completedAt      DateTime?
  durationMs       Int?
  errorMessage     String?
  requiresApproval Boolean        @default(false)
  approvedAt       DateTime?
  approvedBy       String?
  createdAt        DateTime       @default(now())
  updatedAt        DateTime
  users            users?         @relation(fields: [approvedBy], references: [id])
  user_workflows   user_workflows @relation(fields: [workflowId], references: [id], onDelete: Cascade)

  @@index([status])
  @@index([workflowId, stepNumber])
}

model workflow_templates {
  id               String       @id
  tenantId         String
  name             String       @db.VarChar(100)
  description      String?
  type             WorkflowType
  steps            Json
  requiresApproval Boolean      @default(false)
  approvalEmails   String[]
  isActive         Boolean      @default(true)
  createdBy        String
  createdAt        DateTime     @default(now())
  updatedAt        DateTime
  users            users        @relation(fields: [createdBy], references: [id])
  Tenant           Tenant       @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@unique([tenantId, name])
  @@index([tenantId, isActive])
}

model filter_presets {
  id                String   @id
  tenantId          String
  name              String   @db.VarChar(255)
  description       String?
  entityType        String   @db.VarChar(50)
  filterConfig      Json
  filterLogic       String   @default("AND")
  isPublic          Boolean  @default(false)
  isDefault         Boolean  @default(false)
  icon              String?  @db.VarChar(50)
  color             String?  @db.VarChar(50)
  usageCount        Int      @default(0)
  lastUsedAt        DateTime?
  createdBy         String
  createdAt         DateTime @default(now())
  updatedAt         DateTime
  Tenant            Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  creator           users    @relation("FilterPresetCreatedBy", fields: [createdBy], references: [id])

  @@unique([tenantId, name])
  @@index([tenantId, entityType])
  @@index([tenantId, isPublic])
  @@index([createdBy, createdAt])
  @@index([isDefault])
  @@map("filter_presets")
}

enum AvailabilityStatus {
  AVAILABLE
  BUSY
  OFFLINE
  ON_LEAVE
}

enum BookingStatus {
  PENDING
  CONFIRMED
  COMPLETED
  CANCELLED
}

enum BookingType {
  STANDARD
  RECURRING
  EMERGENCY
  CONSULTATION
}

enum BulkOperationStatus {
  DRAFT
  READY
  IN_PROGRESS
  COMPLETED
  FAILED
  CANCELLED
  PAUSED
}

enum BulkOperationType {
  ROLE_CHANGE
  STATUS_UPDATE
  PERMISSION_GRANT
  PERMISSION_REVOKE
  SEND_EMAIL
  IMPORT_CSV
  CUSTOM
}

enum DefaultRole {
  TEAM_MEMBER
  TEAM_LEAD
  ADMIN
}

enum ExpertiseLevel {
  junior
  mid
  senior
  lead
  expert
}

enum InvoiceStatus {
  DRAFT
  SENT
  UNPAID
  PAID
  VOID
}

enum PaymentStatus {
  UNPAID
  PAID
  FAILED
  REFUNDED
  PARTIAL
}

enum PostPriority {
  LOW
  MEDIUM
  HIGH
}

enum PostStatus {
  DRAFT
  PUBLISHED
  SCHEDULED
  ARCHIVED
}

enum Priority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

enum PriorityStatus {
  OPEN
  IN_PROGRESS
  BLOCKED
  DONE
}

enum RequestPriority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

enum RequestStatus {
  DRAFT
  SUBMITTED
  IN_REVIEW
  APPROVED
  ASSIGNED
  IN_PROGRESS
  COMPLETED
  CANCELLED
}

enum ServiceStatus {
  DRAFT
  ACTIVE
  INACTIVE
  DEPRECATED
  RETIRED
}

enum StepStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
  FAILED
  SKIPPED
}

enum TaskPriority {
  LOW
  MEDIUM
  HIGH
}

enum TaskStatus {
  OPEN
  IN_PROGRESS
  REVIEW
  COMPLETED
  BLOCKED
}

enum TenantStatus {
  ACTIVE
  SUSPENDED
  DECOMMISSIONED
}

enum UserRole {
  CLIENT
  TEAM_MEMBER
  TEAM_LEAD
  ADMIN
  STAFF
  SUPER_ADMIN
}

enum WorkOrderStatus {
  DRAFT
  OPEN
  IN_PROGRESS
  ON_HOLD
  BLOCKED
  APPROVAL_PENDING
  COMPLETED
  CANCELLED
}

enum WorkflowStatus {
  DRAFT
  PENDING
  IN_PROGRESS
  PAUSED
  COMPLETED
  FAILED
  CANCELLED
}

enum WorkflowType {
  ONBOARDING
  OFFBOARDING
  ROLE_CHANGE
}
